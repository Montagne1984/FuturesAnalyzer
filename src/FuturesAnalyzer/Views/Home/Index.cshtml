@model FuturesAnalyzer.ViewModels.ReportSettingViewModel
@{
    ViewData["Title"] = "Home Page";
}
<form id="form" asp-action="Report" method="post" class="form-inline" style="margin-top: 20px;">
    <div class="form-group form-inline">
        <label asp-for="TransactionFeeRate">交易手续费率</label>
        <input type="number" min="0" asp-for="TransactionFeeRate" class="form-control" />
    </div>
    <div class="form-group">
        <label asp-for="StopLossUnit">止损份数</label>
        <input type="number" min="0" step="1" asp-for="StopLossUnit" class="form-control" />
    </div>
    <div class="form-group">
        <label asp-for="StopLossCriteria">止损点</label>
        <input type="number" min="0" step="0.001" asp-for="StopLossCriteria" class="form-control" />
    </div>
    <div class="form-group form-inline">
        <label asp-for="StopProfitCriteria">止盈点</label>
        <input type="number" min="0" step="0.01" asp-for="StopProfitCriteria" class="form-control" />
    </div>
    <div class="form-group form-inline">
        <label asp-for="StartProfitCriteria">起盈点</label>
        <input type="number" min="0" step="0.001" asp-for="StartProfitCriteria" class="form-control" />
    </div>
    <div class="form-group form-inline">
        <label asp-for="StartProfitCriteriaForMultiUnits">起盈点（多份）</label>
        <input type="number" min="0" step="0.01" asp-for="StartProfitCriteriaForMultiUnits" class="form-control" />
    </div>
    <div class="form-group form-inline">
        <label asp-for="AppendUnitCountAfterProfitStart">起盈点后加仓份数</label>
        <input type="number" min="0" step="1" asp-for="AppendUnitCountAfterProfitStart" class="form-control" />
    </div>
    <div class="checkbox">
        <label asp-for="NeverEnterAmbiguousState">
            <input asp-for="NeverEnterAmbiguousState" type="checkbox"> 禁用观望期
        </label>
    </div>
    <div class="form-group form-inline">
        <label asp-for="OpenCriteria">开仓点</label>
        <input type="number" min="0" step="0.001" asp-for="OpenCriteria" class="form-control" />
    </div>
    <div class="checkbox">
        <label asp-for="FollowTrend">
            <input asp-for="FollowTrend" type="checkbox"> 开仓顺势
        </label>
    </div>
    <select asp-for="SelectedProductName" class="form-control">
        <option>热轧卷板</option>
        <option>螺纹钢</option>
        <option>焦炭</option>
        <option>焦煤</option>
        <option>热轧卷板1610</option>
        <option>热轧卷板1605</option>
        <option>螺纹钢1605</option>
        <option>焦炭1605</option>
        <option>焦煤1605</option>
        <option>铝</option>
        <option>黄金</option>
        <option>锌</option>
        <option>铜</option>
        <option>铅</option>
        <option>白银</option>
        <option>沥青</option>
        <option>锡</option>
        <option>镍</option>
        <option>菜籽</option>
        <option>硅铁</option>
        <option>锰硅</option>
        <option>强麦</option>
        <option>橡胶</option>
        <option>玻璃</option>
        <option>醇</option>
        <option>菜油</option>
        <option>菜粕</option>
        <option>白糖</option>
        <option>PTA</option>
        <option>动力煤</option>
        <option>豆一</option>
        <option>玉米</option>
        <option>玉米淀粉</option>
        <option>铁矿石</option>
        <option>鸡蛋</option>
        <option>豆粕</option>
        <option>棕榈</option>
        <option>PP</option>
        <option>PVC</option>
        <option>豆油</option>
    </select>
    <div class="form-group form-inline">
        <label asp-for="OpenCriteria">起始日期</label>
        <input type="date" asp-for="StartDate" class="form-control" />
    </div>
    <div class="form-group form-inline">
        <label asp-for="OpenCriteria">结束日期</label>
        <input type="date" asp-for="EndDate" class="form-control" />
    </div>
    <button id="analyze" type="submit" class="btn btn-primary">分析</button>
    @*<button id="optimize" class="btn btn-default">优化</button>*@
</form>
<div id="chart"></div>
<label id="summary"></label>
@section scripts
{
    <script src="http://code.highcharts.com/highcharts.js"></script>
    <script>
        $().ready(function() {
            var d = new Date();
            d.setDate(d.getDate() - 1);
            $('#EndDate').val(toDateFormat(d));
            d.setDate(d.getDate() - 365);
            //$('#StartDate').val(toDateFormat(d));
            $('#StartDate').val('2000-01-01');

            setDefaultSettings();
        });

        function toDateFormat(date) {
            var month = date.getMonth() + 1;
            var fullMonth = month >= 10 ? month : '0' + month;
            var day = date.getDate();
            var fullDay = day >= 10 ? day : '0' + day;
            return date.getFullYear() + "-" + fullMonth + "-" + fullDay;
        }

        $('#form').submit(function(event) {
            event.preventDefault();
            var $inputs = $('#form input');
            var values = {};
            $inputs.each(function() {
                values[this.name] = $(this).val();
            });
            values['SelectedProductName'] = $('#SelectedProductName').val();
            values['NeverEnterAmbiguousState'] = $('#NeverEnterAmbiguousState')[0].checked;
            values['FollowTrend'] = $('#FollowTrend')[0].checked;
            $.post($('#form').attr('action'), values, function (data) {
                var report = data.Report;
                var categories = [];
                var contracts = [];
                var balances = [];
                var prices = [];
                var maxSingleDelta = 0;
                var maxSingleDeltaDate = new Date();
                var minSingleDelta = 0;
                var minSingleDeltaDate = new Date();
                var maxSinglePercentageDelta = 0;
                var maxSinglePercentageDeltaDate = new Date();
                var minSinglePercentageDelta = 0;
                var minSinglePercentageDeltaDate = new Date();
                var minBalance = 0;
                var maxBalance = 0;
                var lastBalance = 0;
                var annualProfits = {};
                var lastYearEndBalance = 0;
                var lastYearStartPrice = 0;
                var yesterdayYear = 0;
                var endBalance = 0;
                var averageBalance = 0;
                var maxUnit = 1;
                var profitCount = 0;
                var lossCount = 0;
                var percentageBalance = 0;
                var dailyPercentageBalance = [];
                if (report.length > 0) {
                    lastYearStartPrice = report[0].DailyPrice.ClosePrice;
                    $.each(report, function(index, value) {
                        categories.push(value.DailyPrice.Date);
                        prices.push(value.DailyPrice.ClosePrice);
                        contracts.push(value.Contract ? value.Contract.Price * value.Contract.Direction * value.Contract.Unit : 0);
                        balances.push(value.Balance);
                        var delta = value.Balance - lastBalance;
                        if (delta > maxSingleDelta) {
                            maxSingleDelta = delta;
                            maxSingleDeltaDate = value.DailyPrice.Date;
                        } else if (delta < minSingleDelta) {
                            minSingleDelta = delta;
                            minSingleDeltaDate = value.DailyPrice.Date;
                        }
                        if (index > 0 && report[index - 1].Contract) {
                            var percentageDelta = delta / (Math.abs(report[index - 1].Contract.Price) * report[index - 1].Contract.Unit);
                            if (percentageDelta > maxSinglePercentageDelta) {
                                maxSinglePercentageDelta = percentageDelta;
                                maxSinglePercentageDeltaDate = value.DailyPrice.Date;
                            } else if (percentageDelta < minSinglePercentageDelta) {
                                minSinglePercentageDelta = percentageDelta;
                                minSinglePercentageDeltaDate = value.DailyPrice.Date;
                            }
                            percentageBalance += percentageDelta;
                        }
                        dailyPercentageBalance.push(percentageBalance);
                        maxBalance = Math.max(maxBalance, value.Balance);
                        minBalance = Math.min(minBalance, value.Balance);
                        lastBalance = value.Balance;
                        var date = new Date(value.DailyPrice.Date);
                        var year = date.getFullYear();
                        if (year !== yesterdayYear) {
                            if (yesterdayYear !== 0) {
                                var yearEndBalance = report[index - 1].Balance;
                                if (report[index - 1].Contract) {
                                    yearEndBalance += (report[index - 1].DailyPrice.ClosePrice - report[index - 1].Contract.Price) * report[index - 1].Contract.Unit * report[index - 1].Contract.Direction;
                                }
                                annualProfits[yesterdayYear] = { profit: yearEndBalance - lastYearEndBalance };
                                annualProfits[yesterdayYear].profitPercentage = annualProfits[yesterdayYear].profit / lastYearStartPrice;
                                lastYearEndBalance = yearEndBalance;
                                lastYearStartPrice = report[index - 1].DailyPrice.ClosePrice;
                            }
                            yesterdayYear = year;
                        }
                        if (value.Contract && value.Contract.Unit > maxUnit) {
                            maxUnit = value.Contract.Unit;
                        }

                        if (value.CloseTransaction && index > 0) {
                            if (report[index].Balance > report[index - 1].Balance) {
                                profitCount++;
                            } else {
                                lossCount++;
                            }
                        }
                    });

                    var endDate = new Date(report[report.length - 1].DailyPrice.Date);
                    var endYear = endDate.getFullYear();
                    annualProfits[endYear] = { profit: report[report.length - 1].Balance - lastYearEndBalance }
                    annualProfits[endYear].profitPercentage = annualProfits[endYear].profit / lastYearStartPrice;
                    endBalance = report[report.length - 1].Balance;
                    averageBalance = endBalance / report.length;
                }

                var totalProfitPercentage = 0;
                $.each(annualProfits, function (key, value) {
                    totalProfitPercentage += value.profitPercentage;
                });
                var averageAnnualProfitPercentage = totalProfitPercentage / Object.keys(annualProfits).length;

                var summaryText =
                    '最终盈利百分比（每笔交易本金相同）：' + percentageBalance * 100 + '%' +
                    '，年化盈利百分比（每笔交易本金相同）：' + percentageBalance / report.length * 250 * 100 + '%' +
                    '，最终盈利：' + endBalance +
                    '，总盈利百分比：' + totalProfitPercentage * 100 + '%' +
                    '，年均盈利百分比：' + averageAnnualProfitPercentage * 100 + '%' +
                    '，日均盈利：' + averageBalance +
                    '，盈利次数：' + profitCount +
                    '，亏损次数：' + lossCount +
                    '，最大份数：' + maxUnit +
                    '，最大盈利：' + maxBalance +
                    '，最小盈利：' + minBalance + 
                    '，最大单日盈利：' + maxSingleDelta + '(' + maxSingleDeltaDate + ')' +
                    '，最大单日亏损：' + minSingleDelta + '(' + minSingleDeltaDate + ')' +
                    '，最大单日盈利比例：' + maxSinglePercentageDelta * 100 + '% (' + maxSinglePercentageDeltaDate + ')' +
                    '，最大单日亏损比例：' + minSinglePercentageDelta * 100 + '%(' + minSinglePercentageDeltaDate + ')';
                summaryText += '<br/>';
                $.each(annualProfits, function(key, value) {
                    summaryText += key + '盈利：' + value.profit + '(' + value.profitPercentage * 100 + '%)' + '&nbsp;&nbsp;&nbsp;';
                });

                $('#summary').html(summaryText);

                $('#chart').show();
                $('#chart').highcharts({
                    chart: {
                        zoomType: 'x'
                    },
                    title: {
                        text: values['SelectedProductName']
                    },
                    xAxis: [
                        {
                            categories: categories,
                            crosshair: true
                        }
                    ],
                    yAxis: [
                        {
                            // Primary yAxis
                            title: {
                                text: '盈亏',
                                style: {
                                    color: Highcharts.getOptions().colors[0]
                                }
                            },
                            labels: {
                                format: '{value}元',
                                style: {
                                    color: Highcharts.getOptions().colors[0]
                                }
                            }
                        }, {
                            // Secondary yAxis
                            labels: {
                                format: '{value}元',
                                style: {
                                    color: Highcharts.getOptions().colors[1]
                                }
                            },
                            title: {
                                text: '价格',
                                style: {
                                    color: Highcharts.getOptions().colors[1]
                                }
                            },
                            opposite: true
                        }
                    ],
                    tooltip: {
                        shared: true
                    },
                    series: [
                        {
                            name: '合约价格',
                            type: 'column',
                            yAxis: 1,
                            data: contracts,
                            tooltip: {
                                valueSuffix: '元'
                            }

                        }, {
                            name: '盈亏',
                            type: 'spline',
                            data: balances,
                            tooltip: {
                                valueSuffix: '元'
                            }
                        },
                        {
                            name: '收盘价',
                            type: 'spline',
                            yAxis: 1,
                            data: prices,
                            tooltip: {
                                valueSuffix: '元'
                            }

                        }
                    ]
                });
            });
        });

        //var settings = {
        //    '热轧卷板': {
        //        TransactionFeeRate: 0.0008,
        //        StopLossCriteria: 0.01,
        //        StopProfitCriteria: 0.1,
        //        StartProfitCriteria: 0.16,
        //        OpenCriteria: 0.01,
        //        FollowTrend: true
        //    },
        //    '铝': {
        //        TransactionFeeRate: 0.0008,
        //        StopLossCriteria: 0.02,
        //        StopProfitCriteria: 0.2,
        //        StartProfitCriteria: 0.1,
        //        OpenCriteria: 0.01,
        //        FollowTrend: false
        //    },
        //    '黄金': {
        //        TransactionFeeRate: 0.0008,
        //        StopLossCriteria: 0.02,
        //        StopProfitCriteria: 0.1,
        //        StartProfitCriteria: 0.06,
        //        OpenCriteria: 0.01,
        //        FollowTrend: true
        //    },
        //    '锌': {
        //        TransactionFeeRate: 0.0008,
        //        StopLossCriteria: 0.02,
        //        StopProfitCriteria: 0.2,
        //        StartProfitCriteria: 0.12,
        //        OpenCriteria: 0.03,
        //        FollowTrend: false
        //    },
        //    '铜': {
        //        TransactionFeeRate: 0.0008,
        //        StopLossCriteria: 0.03,
        //        StopProfitCriteria: 0.2,
        //        StartProfitCriteria: 0.09,
        //        OpenCriteria: 0.03,
        //        FollowTrend: false
        //    },
        //    '螺纹钢': {
        //        TransactionFeeRate: 0.0008,
        //        StopLossCriteria: 0.01,
        //        StopProfitCriteria: 0.1,
        //        StartProfitCriteria: 0.13,
        //        OpenCriteria: 0.01,
        //        FollowTrend: true
        //    },
        //    '铅': {
        //        TransactionFeeRate: 0.0008,
        //        StopLossCriteria: 0.05,
        //        StopProfitCriteria: 0.1,
        //        StartProfitCriteria: 0.09,
        //        OpenCriteria: 0.03,
        //        FollowTrend: false
        //    },
        //    '白银': {
        //        TransactionFeeRate: 0.0008,
        //        StopLossCriteria: 0.02,
        //        StopProfitCriteria: 0.2,
        //        StartProfitCriteria: 0.03,
        //        OpenCriteria: 0.02,
        //        FollowTrend: false
        //    },
        //    '沥青': {
        //        TransactionFeeRate: 0.0008,
        //        StopLossCriteria: 0.03,
        //        StopProfitCriteria: 0.2,
        //        StartProfitCriteria: 0.1,
        //        OpenCriteria: 0.02,
        //        FollowTrend: true
        //    },
        //    '锡': {
        //        TransactionFeeRate: 0.0008,
        //        StopLossCriteria: 0.01,
        //        StopProfitCriteria: 0.1,
        //        StartProfitCriteria: 0.06,
        //        OpenCriteria: 0.02,
        //        FollowTrend: false
        //    },
        //    '镍': {
        //        TransactionFeeRate: 0.0008,
        //        StopLossCriteria: 0.02,
        //        StopProfitCriteria: 0.1,
        //        StartProfitCriteria: 0.06,
        //        OpenCriteria: 0.02,
        //        FollowTrend: false
        //    },
        //    '菜籽': {
        //        TransactionFeeRate: 0.0008,
        //        StopLossCriteria: 0.02,
        //        StopProfitCriteria: 0.2,
        //        StartProfitCriteria: 0.11,
        //        OpenCriteria: 0.02,
        //        FollowTrend: false
        //    },
        //    '硅铁': {
        //        TransactionFeeRate: 0.0008,
        //        StopLossCriteria: 0.02,
        //        StopProfitCriteria: 0.2,
        //        StartProfitCriteria: 0.09,
        //        OpenCriteria: 0.03,
        //        FollowTrend: false
        //    },
        //    '锰硅': {
        //        TransactionFeeRate: 0.0008,
        //        StopLossCriteria: 0.01,
        //        StopProfitCriteria: 0.1,
        //        StartProfitCriteria: 0.14,
        //        OpenCriteria: 0.02,
        //        FollowTrend: false
        //    },
        //    '强麦': {
        //        TransactionFeeRate: 0.0008,
        //        StopLossCriteria: 0.02,
        //        StopProfitCriteria: 0.2,
        //        StartProfitCriteria: 0.17,
        //        OpenCriteria: 0.02,
        //        FollowTrend: false
        //    },
        //    '橡胶': {
        //        TransactionFeeRate: 0.0008,
        //        StopLossCriteria: 0.01,
        //        StopProfitCriteria: 0.2,
        //        StartProfitCriteria: 0.07,
        //        OpenCriteria: 0.01,
        //        FollowTrend: false
        //    },
        //    '玻璃': {
        //        TransactionFeeRate: 0.0008,
        //        StopLossCriteria: 0.01,
        //        StopProfitCriteria: 0.3,
        //        StartProfitCriteria: 0.14,
        //        OpenCriteria: 0.02,
        //        FollowTrend: false
        //    },
        //    '醇': {
        //        TransactionFeeRate: 0.0008,
        //        StopLossCriteria: 0.02,
        //        StopProfitCriteria: 0.1,
        //        StartProfitCriteria: 0.05,
        //        OpenCriteria: 0.02,
        //        FollowTrend: false
        //    },
        //    '菜油': {
        //        TransactionFeeRate: 0.0008,
        //        StopLossCriteria: 0.02,
        //        StopProfitCriteria: 0.1,
        //        StartProfitCriteria: 0.09,
        //        OpenCriteria: 0.05,
        //        FollowTrend: false
        //    },
        //    '菜粕': {
        //        TransactionFeeRate: 0.0008,
        //        StopLossCriteria: 0.02,
        //        StopProfitCriteria: 0.1,
        //        StartProfitCriteria: 0.05,
        //        OpenCriteria: 0.03,
        //        FollowTrend: false
        //    },
        //    '白糖': {
        //        TransactionFeeRate: 0.0008,
        //        StopLossCriteria: 0.02,
        //        StopProfitCriteria: 0.2,
        //        StartProfitCriteria: 0.09,
        //        OpenCriteria: 0.01,
        //        FollowTrend: false
        //    },
        //    'PTA': {
        //        TransactionFeeRate: 0.0008,
        //        StopLossCriteria: 0.01,
        //        StopProfitCriteria: 0.2,
        //        StartProfitCriteria: 0.07,
        //        OpenCriteria: 0.01,
        //        FollowTrend: false
        //    },
        //    '动力煤': {
        //        TransactionFeeRate: 0.0008,
        //        StopLossCriteria: 0.01,
        //        StopProfitCriteria: 0.2,
        //        StartProfitCriteria: 0.06,
        //        OpenCriteria: 0.01,
        //        FollowTrend: true
        //    },
        //    '豆一': {
        //        TransactionFeeRate: 0.0008,
        //        StopLossCriteria: 0.02,
        //        StopProfitCriteria: 0.1,
        //        StartProfitCriteria: 0.08,
        //        OpenCriteria: 0.05,
        //        FollowTrend: false
        //    },
        //    '玉米': {
        //        TransactionFeeRate: 0.0008,
        //        StopLossCriteria: 0.03,
        //        StopProfitCriteria: 0.1,
        //        StartProfitCriteria: 0.1,
        //        OpenCriteria: 0.05,
        //        FollowTrend: false
        //    },
        //    '玉米淀粉': {
        //        TransactionFeeRate: 0.0008,
        //        StopLossCriteria: 0.02,
        //        StopProfitCriteria: 0.1,
        //        StartProfitCriteria: 0.1,
        //        OpenCriteria: 0.02,
        //        FollowTrend: false
        //    },
        //    '铁矿石': {
        //        TransactionFeeRate: 0.0008,
        //        StopLossCriteria: 0.02,
        //        StopProfitCriteria: 0.2,
        //        StartProfitCriteria: 0.13,
        //        OpenCriteria: 0.02,
        //        FollowTrend: false
        //    },
        //    '焦炭': {
        //        TransactionFeeRate: 0.0008,
        //        StopLossCriteria: 0.02,
        //        StopProfitCriteria: 0.2,
        //        StartProfitCriteria: 0.07,
        //        OpenCriteria: 0.02,
        //        FollowTrend: false
        //    },
        //    '鸡蛋': {
        //        TransactionFeeRate: 0.0008,
        //        StopLossCriteria: 0.02,
        //        StopProfitCriteria: 0.3,
        //        StartProfitCriteria: 0.04,
        //        OpenCriteria: 0.03,
        //        FollowTrend: false
        //    },
        //    '焦煤': {
        //        TransactionFeeRate: 0.0008,
        //        StopLossCriteria: 0.03,
        //        StopProfitCriteria: 0.2,
        //        StartProfitCriteria: 0.12,
        //        OpenCriteria: 0.03,
        //        FollowTrend: false
        //    },
        //    '豆粕': {
        //        TransactionFeeRate: 0.0008,
        //        StopLossCriteria: 0.01,
        //        StopProfitCriteria: 0.1,
        //        StartProfitCriteria: 0.03,
        //        OpenCriteria: 0.02,
        //        FollowTrend: false
        //    },
        //    '棕榈': {
        //        TransactionFeeRate: 0.0008,
        //        StopLossCriteria: 0.01,
        //        StopProfitCriteria: 0.2,
        //        StartProfitCriteria: 0.09,
        //        OpenCriteria: 0.03,
        //        FollowTrend: false
        //    },
        //    'PP': {
        //        TransactionFeeRate: 0.0008,
        //        StopLossCriteria: 0.01,
        //        StopProfitCriteria: 0.2,
        //        StartProfitCriteria: 0.04,
        //        OpenCriteria: 0.03,
        //        FollowTrend: false
        //    },
        //    'PVC': {
        //        TransactionFeeRate: 0.0008,
        //        StopLossCriteria: 0.01,
        //        StopProfitCriteria: 0.1,
        //        StartProfitCriteria: 0.07,
        //        OpenCriteria: 0.02,
        //        FollowTrend: false
        //    },
        //    '豆油': {
        //        TransactionFeeRate: 0.0008,
        //        StopLossCriteria: 0.01,
        //        StopProfitCriteria: 0.1,
        //        StartProfitCriteria: 0.08,
        //        OpenCriteria: 0.03,
        //        FollowTrend: false
        //    }
        //};

        var settings = {
            '热轧卷板': {
                TransactionFeeRate: 0.00004,
                StopLossCriteria: 0.006,
                StopProfitCriteria: 0.09,
                StartProfitCriteria: 0.157,
                OpenCriteria: 0.012,
                FollowTrend: true
            },
            '螺纹钢': {
                TransactionFeeRate: 0.000045,
                StopLossCriteria: 0.007,
                StopProfitCriteria: 0.1,
                StartProfitCriteria: 0.128,
                OpenCriteria: 0.01,
                FollowTrend: true
            },
            '焦炭': {
                TransactionFeeRate: 0.00006,
                StopLossCriteria: 0.019,
                StopProfitCriteria: 0.2,
                StartProfitCriteria: 0.068,
                OpenCriteria: 0.022,
                FollowTrend: false
            },
            '焦煤': {
                TransactionFeeRate: 0.00006,
                StopLossCriteria: 0.029,
                StopProfitCriteria: 0.19,
                StartProfitCriteria: 0.12,
                OpenCriteria: 0.03,
                FollowTrend: false
            },
            '热轧卷板1610': {
                TransactionFeeRate: 0.00004,
                StopLossCriteria: 0.006,
                StopProfitCriteria: 0.09,
                StartProfitCriteria: 0.157,
                OpenCriteria: 0.012,
                FollowTrend: true
            },
            '热轧卷板1605': {
                TransactionFeeRate: 0.000045,
                StopLossCriteria: 0.006,
                StopProfitCriteria: 0.09,
                StartProfitCriteria: 0.157,
                OpenCriteria: 0.012,
                FollowTrend: true
            },
            '螺纹钢1605': {
                TransactionFeeRate: 0.00006,
                StopLossCriteria: 0.007,
                StopProfitCriteria: 0.1,
                StartProfitCriteria: 0.128,
                OpenCriteria: 0.01,
                FollowTrend: true
            },
            '焦炭1605': {
                TransactionFeeRate: 0.00006,
                StopLossCriteria: 0.019,
                StopProfitCriteria: 0.2,
                StartProfitCriteria: 0.068,
                OpenCriteria: 0.021,
                FollowTrend: false
            },
            '焦煤1605': {
                TransactionFeeRate: 0.00006,
                StopLossCriteria: 0.029,
                StopProfitCriteria: 0.2,
                StartProfitCriteria: 0.12,
                OpenCriteria: 0.03,
                FollowTrend: false
            },
            '铝': {
                TransactionFeeRate: 0.0008,
                StopLossCriteria: 0.02,
                StopProfitCriteria: 0.19,
                StartProfitCriteria: 0.096,
                OpenCriteria: 0.01,
                FollowTrend: false
            },
            '黄金': {
                TransactionFeeRate: 0.0008,
                StopLossCriteria: 0.02,
                StopProfitCriteria: 0.09,
                StartProfitCriteria: 0.06,
                OpenCriteria: 0.01,
                FollowTrend: true
            },
            '锌': {
                TransactionFeeRate: 0.0008,
                StopLossCriteria: 0.035,
                StopProfitCriteria: 0.19,
                StartProfitCriteria: 0.09,
                OpenCriteria: 0.012,
                FollowTrend: false
            },
            '铜': {
                TransactionFeeRate: 0.0008,
                StopLossCriteria: 0.02,
                StopProfitCriteria: 0.1,
                StartProfitCriteria: 0.076,
                OpenCriteria: 0.018,
                FollowTrend: false
            },
            '铅': {
                TransactionFeeRate: 0.0008,
                StopLossCriteria: 0.011,
                StopProfitCriteria: 0.2,
                StartProfitCriteria: 0.052,
                OpenCriteria: 0.02,
                FollowTrend: false
            },
            '白银': {
                TransactionFeeRate: 0.0008,
                StopLossCriteria: 0.017,
                StopProfitCriteria: 0.17,
                StartProfitCriteria: 0.03,
                OpenCriteria: 0.02,
                FollowTrend: false
            },
            '沥青': {
                TransactionFeeRate: 0.0008,
                StopLossCriteria: 0.026,
                StopProfitCriteria: 0.18,
                StartProfitCriteria: 0.101,
                OpenCriteria: 0.02,
                FollowTrend: true
            },
            '锡': {
                TransactionFeeRate: 0.0008,
                StopLossCriteria: 0.01,
                StopProfitCriteria: 0.09,
                StartProfitCriteria: 0.065,
                OpenCriteria: 0.02,
                FollowTrend: false
            },
            '镍': {
                TransactionFeeRate: 0.0008,
                StopLossCriteria: 0.02,
                StopProfitCriteria: 0.1,
                StartProfitCriteria: 0.06,
                OpenCriteria: 0.021,
                FollowTrend: false
            },
            '菜籽': {
                TransactionFeeRate: 0.0008,
                StopLossCriteria: 0.02,
                StopProfitCriteria: 0.2,
                StartProfitCriteria: 0.11,
                OpenCriteria: 0.02,
                FollowTrend: false
            },
            '硅铁': {
                TransactionFeeRate: 0.0008,
                StopLossCriteria: 0.02,
                StopProfitCriteria: 0.2,
                StartProfitCriteria: 0.09,
                OpenCriteria: 0.03,
                FollowTrend: false
            },
            '锰硅': {
                TransactionFeeRate: 0.0008,
                StopLossCriteria: 0.01,
                StopProfitCriteria: 0.1,
                StartProfitCriteria: 0.14,
                OpenCriteria: 0.02,
                FollowTrend: false
            },
            '强麦': {
                TransactionFeeRate: 0.0008,
                StopLossCriteria: 0.02,
                StopProfitCriteria: 0.2,
                StartProfitCriteria: 0.17,
                OpenCriteria: 0.02,
                FollowTrend: false
            },
            '橡胶': {
                TransactionFeeRate: 0.0008,
                StopLossCriteria: 0.01,
                StopProfitCriteria: 0.2,
                StartProfitCriteria: 0.07,
                OpenCriteria: 0.01,
                FollowTrend: false
            },
            '玻璃': {
                TransactionFeeRate: 0.0008,
                StopLossCriteria: 0.01,
                StopProfitCriteria: 0.3,
                StartProfitCriteria: 0.14,
                OpenCriteria: 0.02,
                FollowTrend: false
            },
            '醇': {
                TransactionFeeRate: 0.0008,
                StopLossCriteria: 0.02,
                StopProfitCriteria: 0.1,
                StartProfitCriteria: 0.05,
                OpenCriteria: 0.02,
                FollowTrend: false
            },
            '菜油': {
                TransactionFeeRate: 0.0008,
                StopLossCriteria: 0.02,
                StopProfitCriteria: 0.1,
                StartProfitCriteria: 0.09,
                OpenCriteria: 0.05,
                FollowTrend: false
            },
            '菜粕': {
                TransactionFeeRate: 0.0008,
                StopLossCriteria: 0.02,
                StopProfitCriteria: 0.1,
                StartProfitCriteria: 0.05,
                OpenCriteria: 0.03,
                FollowTrend: false
            },
            '白糖': {
                TransactionFeeRate: 0.0008,
                StopLossCriteria: 0.02,
                StopProfitCriteria: 0.2,
                StartProfitCriteria: 0.09,
                OpenCriteria: 0.01,
                FollowTrend: false
            },
            'PTA': {
                TransactionFeeRate: 0.0008,
                StopLossCriteria: 0.01,
                StopProfitCriteria: 0.2,
                StartProfitCriteria: 0.07,
                OpenCriteria: 0.01,
                FollowTrend: false
            },
            '动力煤': {
                TransactionFeeRate: 0.0008,
                StopLossCriteria: 0.01,
                StopProfitCriteria: 0.2,
                StartProfitCriteria: 0.06,
                OpenCriteria: 0.01,
                FollowTrend: true
            },
            '豆一': {
                TransactionFeeRate: 0.0008,
                StopLossCriteria: 0.02,
                StopProfitCriteria: 0.1,
                StartProfitCriteria: 0.08,
                OpenCriteria: 0.05,
                FollowTrend: false
            },
            '玉米': {
                TransactionFeeRate: 0.0008,
                StopLossCriteria: 0.03,
                StopProfitCriteria: 0.1,
                StartProfitCriteria: 0.1,
                OpenCriteria: 0.05,
                FollowTrend: false
            },
            '玉米淀粉': {
                TransactionFeeRate: 0.0008,
                StopLossCriteria: 0.02,
                StopProfitCriteria: 0.1,
                StartProfitCriteria: 0.1,
                OpenCriteria: 0.02,
                FollowTrend: false
            },
            '铁矿石': {
                TransactionFeeRate: 0.0008,
                StopLossCriteria: 0.02,
                StopProfitCriteria: 0.2,
                StartProfitCriteria: 0.13,
                OpenCriteria: 0.02,
                FollowTrend: false
            },
            '鸡蛋': {
                TransactionFeeRate: 0.0008,
                StopLossCriteria: 0.02,
                StopProfitCriteria: 0.3,
                StartProfitCriteria: 0.04,
                OpenCriteria: 0.03,
                FollowTrend: false
            },
            '豆粕': {
                TransactionFeeRate: 0.0008,
                StopLossCriteria: 0.01,
                StopProfitCriteria: 0.1,
                StartProfitCriteria: 0.03,
                OpenCriteria: 0.02,
                FollowTrend: false
            },
            '棕榈': {
                TransactionFeeRate: 0.0008,
                StopLossCriteria: 0.01,
                StopProfitCriteria: 0.2,
                StartProfitCriteria: 0.09,
                OpenCriteria: 0.03,
                FollowTrend: false
            },
            'PP': {
                TransactionFeeRate: 0.0008,
                StopLossCriteria: 0.01,
                StopProfitCriteria: 0.2,
                StartProfitCriteria: 0.04,
                OpenCriteria: 0.03,
                FollowTrend: false
            },
            'PVC': {
                TransactionFeeRate: 0.0008,
                StopLossCriteria: 0.01,
                StopProfitCriteria: 0.1,
                StartProfitCriteria: 0.07,
                OpenCriteria: 0.02,
                FollowTrend: false
            },
            '豆油': {
                TransactionFeeRate: 0.0008,
                StopLossCriteria: 0.01,
                StopProfitCriteria: 0.1,
                StartProfitCriteria: 0.08,
                OpenCriteria: 0.03,
                FollowTrend: false
            }
        };

        $('#SelectedProductName').change(function() {
            setDefaultSettings();
        });

        function setDefaultSettings() {
            var selectedProductName = $('#SelectedProductName').val();
            if (settings[selectedProductName]) {
                $('#TransactionFeeRate').val(settings[selectedProductName].TransactionFeeRate);
                $('#StopLossCriteria').val(settings[selectedProductName].StopLossCriteria);
                $('#StopProfitCriteria').val(settings[selectedProductName].StopProfitCriteria);
                $('#StartProfitCriteria').val(settings[selectedProductName].StartProfitCriteria);
                $('#OpenCriteria').val(settings[selectedProductName].OpenCriteria);
                $('#FollowTrend').prop('checked', settings[selectedProductName].FollowTrend);
            }
        }

        //$('#optimize').click(function (event) {
        //    event.preventDefault();
        //    var $inputs = $('#form input');
        //    var values = {};
        //    $inputs.each(function() {
        //        values[this.name] = $(this).val();
        //    });
        //    values['SelectedProductName'] = $('#SelectedProductName').val();
        //    values['FollowTrend'] = $('#FollowTrend')[0].checked;
        //    $.post('home/optimize', values, function(data) {
        //        $('#chart').hide();
        //        var optimizationResult = '优化结果<br/>止损点：' + data.StopLossCriteria + '，止盈点：' + data.StopProfitCriteria + '，起盈点：' + data.StartProfitCriteria + '，开仓点：' + OpenCriteria + '，开仓顺势：' + data.FollowTrend;
        //        $('#summary').html(optimizationResult);
        //    });
        //});
    </script>
}